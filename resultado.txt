- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\docker-compose.yml:
# gerencia os containers da aplicação java (app) e do banco de dados (db)

version: '3.8'
services:

  # banco de dados posgresql
  db:
    image: postgres:14 #usa imagem oficial do postgres versão 14
    container_name: postgres_db_poow1
    restart: always
    environment: #define usuário, senha e nome do banco de dados
      - POSTGRES_USER: postgres
      - POSTGRES_PASSWORD: 1234
      - POSTGRES_DB: poow_trabalho
    ports:
      # expõe a porta 5432 do banco de dados para o host
      - "5432:5432"
    volumes:
      # persiste os dados do banco de dados no pc
      - db_data:/var/lib/postgresql/data
      # inicializa o banco de dados com seu script SQL na 1a vez que o container é criado
      - ./poow_trabalho.sql:/docker-entrypoint-initdb.d/init.sql
  
  #aplicação java no wildfly
  app:
    build: . # usa o Dockerfile para construir a imagem do app
    # instrui o compose a construir uma imagem a partir do Dockerfile no diretório atual
    container_name: wildfly_app_poow1
    restart: always
    ports:
      # mapeia a porta 8080 do host para a porta 8080 do container (onde wildfly roda)
      - "8080:8080" # para acesso ao app via navegador
      # mapeia a porta 9990 (administrativa do wildfly) 
      - "9990:9990" 
    volumes:
      # mapeia pasta de logs do wildfly para pasta 'logs' no pc, espelha logs do wildfly
      - ./logs:/opt/jboss/wildfly/standalone/log
    # garante que o container do app só inicie com o banco de dados pronto
    depends_on: # ordem de inicialização dos containers
      - db
    # variaveis de ambiente para java  
    environment: 
      - DB_HOST: db # nome do serviço do banco de dados
      - DB_PORT: 5432 # porta do banco de dados
      - DB_NAME: poow_trabalho # nome do banco de dados
      - DB_USER: postgres # usuário do banco de dados
      - DB_PASS: 1234 # senha do usuário do banco de dados

# volumes persistentes para o banco de dados
volumes:
  db_data:

- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\Dockerfile:
# multi-stage build: compila código com maven, pega arquivo .war e coloca em servidor wildfly | um container para compilar código, otro para rodar - imagem final menor

# estágio 1 -- builder -- imagem oficial do maven com java 17
FROM maven:3.9-eclipse-temurin-17 AS builder

# define diretório de trabalho no container
WORKDIR /app

# copia pom.xml
COPY pom.xml .

# copia código fonte
COPY src ./src

# comando do maven para compilar o código e gerar o arquivo .war
# -DskipTests: não executa os testes
RUN mvn clean package -DskipTests

# estágio 2 -- runtime -- imagem oficial do wildfly
FROM jboss/wildfly:36.0.0.Final

# copia do arquivo .war gerado no builder para a pasta de deploy do wildfly
# wildfly implanta .war da pasta
# 'biblioteca.war' da tag <finalName> do pom.xml
COPY --from=builder /app/target/biblioteca.war /opt/jboss/wildfly/standalone/deployments/

# ENTRYPOINT já é definido na imagem do wildfly, porta 8080 exposta por padrão


- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\pom.xml:
<?xml version="1.0" encoding="UTF-8"?>

<!--ALTERADO COPILOT-->

<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>br.csi</groupId>
    <artifactId>biblioteca</artifactId>
    <version>1.0-SNAPSHOT</version>
    <name>biblioteca</name>
    <packaging>war</packaging>
    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.target>17</maven.compiler.target>
        <maven.compiler.source>17</maven.compiler.source>
        <junit.version>5.11.0-M2</junit.version>
    </properties>
    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>jakarta.enterprise</groupId>
            <artifactId>jakarta.enterprise.cdi-api</artifactId>
            <version>4.1.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>jakarta.ws.rs</groupId>
            <artifactId>jakarta.ws.rs-api</artifactId>
            <version>4.0.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>jakarta.servlet</groupId>
            <artifactId>jakarta.servlet-api</artifactId>
            <version>6.0.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-api</artifactId>
            <version>${junit.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-engine</artifactId>
            <version>${junit.version}</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
            <version>42.7.3</version>
        </dependency>
        <dependency>
            <groupId>jakarta.servlet.jsp.jstl</groupId>
            <artifactId>jakarta.servlet.jsp.jstl-api</artifactId>
            <version>3.0.0</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.glassfish.web</groupId>
            <artifactId>jakarta.servlet.jsp.jstl</artifactId>
            <version>3.0.1</version>
            <scope>runtime</scope>
            <exclusions>
                <exclusion>
                    <groupId>jakarta.servlet</groupId>
                    <artifactId>jakarta.servlet-api</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <version>3.4.0</version>
            </plugin>
        </plugins>
        <finalName>biblioteca</finalName>
    </build>
</project>


- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\AutorController.java:
package br.csi.controller;
import br.csi.dao.AutorDAO;
import br.csi.model.Autor;
import br.csi.model.Usuario;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;
import java.util.ArrayList;

@WebServlet("/autores")
public class AutorController extends HttpServlet {
    private final AutorDAO autorDAO = new AutorDAO();

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        if (usuario.getTipo_us().equals("USUARIO")) {
            req.setAttribute("mensagemAcessoNegado", "Você não tem acesso a essa página.");
            req.getRequestDispatcher("/WEB-INF/acessoNegado.jsp").forward(req, resp);
            return;
        }

        String acao = req.getParameter("acao");
        if (acao != null && acao.equals("novo")) {
            req.getRequestDispatcher("/WEB-INF/autor/editar.jsp").forward(req, resp);
            return;
        }

        if (acao != null && acao.equals("editar")) {
            int id = Integer.parseInt(req.getParameter("id"));
            Autor autor = autorDAO.getAutorById(id);
            req.setAttribute("autorEdicao", autor);
            req.getRequestDispatcher("/WEB-INF/autor/editar.jsp").forward(req, resp);
            return;
        }

        if (acao != null && acao.equals("excluir")) {
            int id = Integer.parseInt(req.getParameter("id"));
            String resultado = autorDAO.excluir(id);
            req.getSession().setAttribute("mensagem", resultado);
            resp.sendRedirect(req.getContextPath() + "/autores");
            return;
        }

        ArrayList<Autor> autores = autorDAO.getAutores();
        req.setAttribute("autores", autores);
        req.getRequestDispatcher("/WEB-INF/autor/listar.jsp").forward(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        if (usuario.getTipo_us().equals("USUARIO")) {
            req.setAttribute("mensagemAcessoNegado", "Você não tem acesso a essa página.");
            req.getRequestDispatcher("/WEB-INF/acessoNegado.jsp").forward(req, resp);
            return;
        }

        Autor autor = new Autor();
        try {
            autor.setNome_aut(req.getParameter("nome"));
            autor.setNacionalidade_aut(req.getParameter("nacionalidade"));
            autor.setData_nascimento_aut(req.getParameter("data_nascimento"));

            String idParam = req.getParameter("id");
            String resultado;

            if (idParam != null && !idParam.isEmpty()) {
                autor.setId_aut(Integer.parseInt(idParam));
                resultado = autorDAO.alterar(autor);
            } else {
                resultado = autorDAO.inserir(autor);
            }

            req.getSession().setAttribute("mensagem", resultado);
        } catch (Exception e) {
            req.getSession().setAttribute("mensagem", "Erro: " + e.getMessage());
        }

        resp.sendRedirect(req.getContextPath() + "/autores");
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\EmprestimoController.java:
package br.csi.controller;
import br.csi.dao.EmprestimoDAO;
import br.csi.dao.LivroDAO;
import br.csi.dao.UsuarioDAO;
import br.csi.model.Emprestimo;
import br.csi.model.Usuario;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;
import java.sql.Date;
import java.util.Calendar;
import java.util.ArrayList;


@WebServlet("/emprestimos")
public class EmprestimoController extends HttpServlet {
    private final EmprestimoDAO emprestimoDAO = new EmprestimoDAO();
    private final LivroDAO livroDAO = new LivroDAO();
    private final UsuarioDAO usuarioDAO = new UsuarioDAO();

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");

        String acao = req.getParameter("acao");
        if (acao != null) {
            if (acao.equals("devolver")) {
                int id = Integer.parseInt(req.getParameter("id"));
                String resultado = emprestimoDAO.devolver(id);
                req.getSession().setAttribute("mensagem", resultado);
            } else if (acao.equals("novo")) {
                req.setAttribute("livros", livroDAO.getLivrosDisponiveis());
                req.setAttribute("usuarios", usuarioDAO.getUsuariosAtivos());
                req.getRequestDispatcher("/WEB-INF/emprestimo/editar.jsp").forward(req, resp);
                return;
            }
        }
        ArrayList<Emprestimo> emprestimos = emprestimoDAO.getEmprestimos();
        req.setAttribute("emprestimos", emprestimos);
        req.getRequestDispatcher("/WEB-INF/emprestimo/listar.jsp").forward(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");

        String livroParam = req.getParameter("livro");
        String usuarioParam = req.getParameter("usuario");

        if (livroParam == null || usuarioParam == null || livroParam.isEmpty() || usuarioParam.isEmpty()) {
            req.getSession().setAttribute("mensagem", "Erro: Todos os campos são obrigatórios.");
            resp.sendRedirect(req.getContextPath() + "/emprestimos");
            return;
        }

        Emprestimo emprestimo = new Emprestimo();
        emprestimo.setId_livro_emp(Integer.parseInt(livroParam));
        emprestimo.setId_usuario_emp(Integer.parseInt(usuarioParam));
        emprestimo.setData_emprestimo_emp(new Date(System.currentTimeMillis()));

        Calendar cal = Calendar.getInstance();
        cal.add(Calendar.DATE, 14);
        emprestimo.setData_devolucao_prevista_emp(new Date(cal.getTimeInMillis()));
        emprestimo.setStatus_emp("ATIVO");

        String resultado = emprestimoDAO.inserir(emprestimo);
        req.getSession().setAttribute("mensagem", resultado);
        resp.sendRedirect(req.getContextPath() + "/emprestimos");
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\HomeController.java:
package br.csi.controller;
import br.csi.model.Usuario;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;


@WebServlet("/home")
public class HomeController extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }
        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        if (!usuario.getTipo_us().equals("ADMIN")) { // Only ADMIN can access home
            resp.sendRedirect(req.getContextPath() + "/meus-emprestimos");
            return;
        }
        req.getRequestDispatcher("/WEB-INF/home.jsp").forward(req, resp);
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\LivroController.java:
package br.csi.controller;

import br.csi.dao.AutorDAO;
import br.csi.dao.LivroDAO;
import br.csi.model.Livro;
import br.csi.model.Usuario;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;
import java.util.ArrayList;


@WebServlet("/livros")
public class LivroController extends HttpServlet {
    private final LivroDAO livroDAO = new LivroDAO();
    private final AutorDAO autorDAO = new AutorDAO();

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        if (usuario.getTipo_us().equals("USUARIO")) {
            req.setAttribute("mensagemAcessoNegado", "Você não tem acesso a essa página.");
            req.getRequestDispatcher("/WEB-INF/acessoNegado.jsp").forward(req, resp);
            return;
        }

        String acao = req.getParameter("acao");
        if (acao != null) {
            if (acao.equals("excluir")) {
                int id = Integer.parseInt(req.getParameter("id"));
                String resultado = livroDAO.excluir(id);
                req.getSession().setAttribute("mensagem", resultado);
            } else if (acao.equals("editar")) {
                int id = Integer.parseInt(req.getParameter("id"));
                Livro livro = livroDAO.getLivroById(id);
                req.setAttribute("livro", livro);
                req.setAttribute("autores", autorDAO.getAutores());
                req.getRequestDispatcher("/WEB-INF/livro/editar.jsp").forward(req, resp);
                return;
            } else if (acao.equals("novo")) {
                req.setAttribute("autores", autorDAO.getAutores());
                req.getRequestDispatcher("/WEB-INF/livro/editar.jsp").forward(req, resp);
                return;
            }
        }
        ArrayList<Livro> livros = livroDAO.getLivros();
        req.setAttribute("livros", livros);
        req.getRequestDispatcher("/WEB-INF/livro/listar.jsp").forward(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        if (usuario.getTipo_us().equals("USUARIO")) {
            req.setAttribute("mensagemAcessoNegado", "Você não tem acesso a essa página.");
            req.getRequestDispatcher("/WEB-INF/acessoNegado.jsp").forward(req, resp);
            return;
        }

        String titulo = req.getParameter("titulo");
        String isbn = req.getParameter("isbn");
        String anoParam = req.getParameter("ano");
        String autorParam = req.getParameter("autor");
        if (titulo == null || isbn == null || anoParam == null || autorParam == null ||
                titulo.isEmpty() || isbn.isEmpty() || anoParam.isEmpty() || autorParam.isEmpty()) {
            req.getSession().setAttribute("mensagem", "Erro: Todos os campos são obrigatórios.");
            resp.sendRedirect(req.getContextPath() + "/livros");
            return;
        }

        Livro livro = new Livro();
        String idParam = req.getParameter("id");
        if (idParam != null && !idParam.isEmpty()) {
            livro.setId_liv(Integer.parseInt(idParam));
        }
        livro.setTitulo_liv(titulo);
        livro.setIsbn_liv(isbn);
        livro.setAno_publicacao_liv(Integer.parseInt(anoParam));
        livro.setId_autor_liv(Integer.parseInt(autorParam));
        livro.setDisponivel_liv(true);

        String resultado;
        if (idParam != null && !idParam.isEmpty()) {
            resultado = livroDAO.alterar(livro);
        } else {
            resultado = livroDAO.inserir(livro);
        }
        req.getSession().setAttribute("mensagem", resultado);
        resp.sendRedirect(req.getContextPath() + "/livros");
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\LoginController.java:
package br.csi.controller;
import br.csi.dao.UsuarioDAO;
import br.csi.model.Usuario;
import br.csi.service.LoginService;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;

import java.io.IOException;

@WebServlet("/login")
public class LoginController extends HttpServlet {

    private static LoginService service = new LoginService();

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        req.getRequestDispatcher("/login.jsp").forward(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String email = req.getParameter("email");
        String senha = req.getParameter("senha");

        Usuario usuario =  service.autenticar(email, senha);
        if ( usuario != null) {
            HttpSession session = req.getSession();
            session.setAttribute("usuarioLogado", usuario);
            // Increase session timeout to 60 minutes (3600 seconds)
            session.setMaxInactiveInterval(3600); // 60 minutes

            resp.sendRedirect(req.getContextPath() + "/home");

        } else {
            req.setAttribute("erro", "Email ou senha incorretos");
            req.getRequestDispatcher("/login.jsp").forward(req, resp);
        }
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\LogoutController.java:
package br.csi.controller;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;

@WebServlet("/logout")
public class LogoutController extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session != null) {
            session.invalidate();
        }
        resp.sendRedirect(req.getContextPath() + "/login");
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\controller\MeusEmprestimosController.java:
package br.csi.controller;
import br.csi.dao.EmprestimoDAO;
import br.csi.dao.LivroDAO; // Adicionado para buscar livros disponíveis
import br.csi.dao.UsuarioDAO; // Adicionado para buscar usuários ativos
import br.csi.model.Emprestimo;
import br.csi.model.Usuario;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;
import java.sql.Date;
import java.util.ArrayList;
import java.util.Calendar;

@WebServlet("/meus-emprestimos")
public class MeusEmprestimosController extends HttpServlet {
    private final EmprestimoDAO emprestimoDAO = new EmprestimoDAO();
    private final LivroDAO livroDAO = new LivroDAO(); // Instanciar LivroDAO
    private final UsuarioDAO usuarioDAO = new UsuarioDAO(); // Instanciar UsuarioDAO

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuario = (Usuario) session.getAttribute("usuarioLogado");
        ArrayList<Emprestimo> emprestimos = emprestimoDAO.getEmprestimosPorUsuario(usuario.getId_us());

        req.setAttribute("emprestimos", emprestimos);
        req.getRequestDispatcher("/WEB-INF/emprestimo/meus-emprestimos.jsp").forward(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession session = req.getSession(false);
        if (session == null || session.getAttribute("usuarioLogado") == null) {
            resp.sendRedirect(req.getContextPath() + "/login");
            return;
        }

        Usuario usuarioLogado = (Usuario) session.getAttribute("usuarioLogado");

        String acao = req.getParameter("acao");
        if ("novo".equals(acao)) {
            // Logic to create a new loan (similar to EmprestimoController's doPost for new loan)
            String livroParam = req.getParameter("livro");
            // The user making the request is the current logged in user
            String usuarioParam = String.valueOf(usuarioLogado.getId_us());

            if (livroParam == null || livroParam.isEmpty()) {
                req.getSession().setAttribute("mensagem", "Erro: Selecione um livro para empréstimo.");
                resp.sendRedirect(req.getContextPath() + "/meus-emprestimos");
                return;
            }

            Emprestimo emprestimo = new Emprestimo();
            emprestimo.setId_livro_emp(Integer.parseInt(livroParam));
            emprestimo.setId_usuario_emp(Integer.parseInt(usuarioParam));
            emprestimo.setData_emprestimo_emp(new Date(System.currentTimeMillis()));

            Calendar cal = Calendar.getInstance();
            cal.add(Calendar.DATE, 14);
            emprestimo.setData_devolucao_prevista_emp(new Date(cal.getTimeInMillis()));
            emprestimo.setStatus_emp("ATIVO");

            String resultado = emprestimoDAO.inserir(emprestimo);
            req.getSession().setAttribute("mensagem", resultado);
            resp.sendRedirect(req.getContextPath() + "/meus-emprestimos");
            return;
        } else if ("devolver".equals(acao)) {
            int id = Integer.parseInt(req.getParameter("id"));
            String resultado = emprestimoDAO.devolver(id);
            req.getSession().setAttribute("mensagem", resultado);
            resp.sendRedirect(req.getContextPath() + "/meus-emprestimos");
            return;
        }

        // If no specific action, just redirect to list
        resp.sendRedirect(req.getContextPath() + "/meus-emprestimos");
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\dao\AutorDAO.java:
package br.csi.dao;
import br.csi.model.Autor;
import java.sql.*;
import java.util.ArrayList;

public class AutorDAO {

    public String inserir(Autor autor) {
        String sql = "INSERT INTO autor (nome_aut, nacionalidade_aut, data_nascimento_aut) VALUES (?, ?, ?)";
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres();
             PreparedStatement stmt = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {

            stmt.setString(1, autor.getNome_aut());
            stmt.setString(2, autor.getNacionalidade_aut());
            stmt.setDate(3, Date.valueOf(autor.getData_nascimento_aut()));

            int affectedRows = stmt.executeUpdate();

            if (affectedRows == 0) {
                return "Falha ao criar autor. Nenhuma linha afetada.";
            }

            try (ResultSet generatedKeys = stmt.getGeneratedKeys()) {
                if (generatedKeys.next()) {
                    autor.setId_aut(generatedKeys.getInt(1));
                }
            }

            return "Autor criado com sucesso!";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao criar autor: " + e.getMessage();
        }
    }

    public String alterar(Autor autor) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            conn.setAutoCommit(false);
            PreparedStatement stmt = conn.prepareStatement(
                    "UPDATE autor SET nome_aut = ?, nacionalidade_aut = ?, data_nascimento_aut = ? WHERE id_aut = ?"
            );
            stmt.setString(1, autor.getNome_aut());
            stmt.setString(2, autor.getNacionalidade_aut());
            stmt.setDate(3, Date.valueOf(autor.getData_nascimento_aut()));
            stmt.setInt(4, autor.getId_aut());
            int updateCount = stmt.executeUpdate();
            conn.commit();
            if (updateCount <= 0) {
                return "Nenhum autor alterado";
            }
            return "Autor alterado com sucesso";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao alterar autor: " + e.getMessage();
        }
    }

    public static String excluir(int id) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement("DELETE FROM autor WHERE id_aut = ?");
            stmt.setInt(1, id);
            int updateCount = stmt.executeUpdate();
            if (updateCount <= 0) {
                return "Nenhum autor excluído";
            }
            return "Autor excluído com sucesso";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao excluir autor: " + e.getMessage();
        }
    }

    public static Autor getAutorById(int id) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement("SELECT * FROM autor WHERE id_aut = ?");
            stmt.setInt(1, id);
            ResultSet rs = stmt.executeQuery();
            if (rs.next()) {
                Autor a = new Autor();
                a.setId_aut(rs.getInt("id_aut"));
                a.setNome_aut(rs.getString("nome_aut"));
                a.setNacionalidade_aut(rs.getString("nacionalidade_aut"));
                a.setData_nascimento_aut(rs.getDate("data_nascimento_aut").toString());
                return a;
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return null;
    }

    public ArrayList<Autor> getAutores() {
        ArrayList<Autor> autores = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres();
             Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery("SELECT * FROM autor")) {
            while (rs.next()) {
                Autor a = new Autor();
                a.setId_aut(rs.getInt("id_aut"));
                a.setNome_aut(rs.getString("nome_aut"));
                a.setNacionalidade_aut(rs.getString("nacionalidade_aut"));
                a.setData_nascimento_aut(rs.getDate("data_nascimento_aut").toString());
                autores.add(a);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return autores;
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\dao\ConectarBancoDados.java:
package br.csi.dao;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class ConectarBancoDados {
    public static Connection conectarBancoPostgres() throws ClassNotFoundException, SQLException {
        Class.forName("org.postgresql.Driver");
        String url = "jdbc:postgresql://localhost:5432/poow_trabalho";
        String user = "postgres";
        String senha = "1234";
        return DriverManager.getConnection(url, user, senha);
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\dao\EmprestimoDAO.java:
package br.csi.dao;
import br.csi.model.Emprestimo;
import java.sql.*;
import java.util.ArrayList;

public class EmprestimoDAO {
    public String inserir(Emprestimo emprestimo) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            conn.setAutoCommit(false);
            PreparedStatement stmtEmp = conn.prepareStatement(
                    "INSERT INTO emprestimo (id_livro_emp, id_usuario_emp, data_emprestimo_emp, data_devolucao_prevista_emp, status_emp) VALUES (?, ?, ?, ?, ?)"
            );
            stmtEmp.setInt(1, emprestimo.getId_livro_emp());
            stmtEmp.setInt(2, emprestimo.getId_usuario_emp());
            stmtEmp.setDate(3, emprestimo.getData_emprestimo_emp());
            stmtEmp.setDate(4, emprestimo.getData_devolucao_prevista_emp());
            stmtEmp.setString(5, emprestimo.getStatus_emp());
            stmtEmp.executeUpdate();
            PreparedStatement stmtLivro = conn.prepareStatement("UPDATE livro SET disponivel_liv = false WHERE id_liv = ?");
            stmtLivro.setInt(1, emprestimo.getId_livro_emp());
            stmtLivro.executeUpdate();

            conn.commit();
            return "Empréstimo registrado com sucesso";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao registrar empréstimo";
        }
    }

    public ArrayList<Emprestimo> getEmprestimos() {
        ArrayList<Emprestimo> emprestimos = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            String sql = "SELECT e.*, l.titulo_liv as titulo_livro, u.nome_us as nome_usuario " +
                    "FROM emprestimo e " +
                    "JOIN livro l ON e.id_livro_emp = l.id_liv " +
                    "JOIN usuario u ON e.id_usuario_emp = u.id_us";

            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            while (rs.next()) {
                Emprestimo e = new Emprestimo();
                e.setId_emp(rs.getInt("id_emp"));
                e.setId_livro_emp(rs.getInt("id_livro_emp"));
                e.setId_usuario_emp(rs.getInt("id_usuario_emp"));
                e.setData_emprestimo_emp(rs.getDate("data_emprestimo_emp"));
                e.setData_devolucao_prevista_emp(rs.getDate("data_devolucao_prevista_emp"));
                e.setData_devolucao_efetiva_emp(rs.getDate("data_devolucao_efetiva_emp"));
                e.setStatus_emp(rs.getString("status_emp"));

                // Adiciona os dados relacionados
                e.setTitulo_livro(rs.getString("titulo_livro"));
                e.setNome_usuario(rs.getString("nome_usuario"));

                emprestimos.add(e);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return emprestimos;
    }

    public ArrayList<Emprestimo> getEmprestimosPorUsuario(int idUsuario) {
        ArrayList<Emprestimo> emprestimos = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            String sql = "SELECT e.*, l.titulo_liv as titulo_livro, u.nome_us as nome_usuario " +
                    "FROM emprestimo e " +
                    "JOIN livro l ON e.id_livro_emp = l.id_liv " +
                    "JOIN usuario u ON e.id_usuario_emp = u.id_us " +
                    "WHERE e.id_usuario_emp = ?";
            PreparedStatement stmt = conn.prepareStatement(sql);
            stmt.setInt(1, idUsuario);
            ResultSet rs = stmt.executeQuery();
            while (rs.next()) {
                Emprestimo e = new Emprestimo();
                e.setId_emp(rs.getInt("id_emp"));
                e.setId_livro_emp(rs.getInt("id_livro_emp"));
                e.setId_usuario_emp(rs.getInt("id_usuario_emp"));
                e.setData_emprestimo_emp(rs.getDate("data_emprestimo_emp"));
                e.setData_devolucao_prevista_emp(rs.getDate("data_devolucao_prevista_emp"));
                e.setData_devolucao_efetiva_emp(rs.getDate("data_devolucao_efetiva_emp"));
                e.setStatus_emp(rs.getString("status_emp"));
                e.setTitulo_livro(rs.getString("titulo_livro"));
                e.setNome_usuario(rs.getString("nome_usuario"));
                emprestimos.add(e);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return emprestimos;
    }

    public String devolver(int idEmprestimo) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            conn.setAutoCommit(false);
            PreparedStatement stmtEmp = conn.prepareStatement(
                    "UPDATE emprestimo SET status_emp = 'CONCLUIDO', data_devolucao_efetiva_emp = CURRENT_DATE WHERE id_emp = ?"
            );
            stmtEmp.setInt(1, idEmprestimo);
            stmtEmp.executeUpdate();

            PreparedStatement stmtGetLivro = conn.prepareStatement("SELECT id_livro_emp FROM emprestimo WHERE id_emp = ?");
            stmtGetLivro.setInt(1, idEmprestimo);
            ResultSet rs = stmtGetLivro.executeQuery();
            if (rs.next()) {
                int idLivro = rs.getInt("id_livro_emp");
                PreparedStatement stmtLivro = conn.prepareStatement("UPDATE livro SET disponivel_liv = true WHERE id_liv = ?");
                stmtLivro.setInt(1, idLivro);
                stmtLivro.executeUpdate();
            }
            conn.commit();
            return "Devolução registrada com sucesso";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao registrar devolução";
        }
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\dao\LivroDAO.java:
package br.csi.dao;
import br.csi.model.Livro;
import java.sql.*;
import java.util.ArrayList;

public class LivroDAO {
    public String inserir(Livro livro) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            conn.setAutoCommit(false);
            PreparedStatement stmt = conn.prepareStatement(
                    "INSERT INTO livro (titulo_liv, isbn_liv, ano_publicacao_liv, id_autor_liv, disponivel_liv) VALUES (?, ?, ?, ?, ?)"
            );
            stmt.setString(1, livro.getTitulo_liv());
            stmt.setString(2, livro.getIsbn_liv());
            stmt.setInt(3, livro.getAno_publicacao_liv());
            stmt.setInt(4, livro.getId_autor_liv());
            stmt.setBoolean(5, livro.isDisponivel_liv());
            stmt.executeUpdate();
            conn.commit();
            return "Livro inserido com sucesso";
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
            return "Erro ao inserir livro";
        }
    }

    public ArrayList<Livro> getLivros() {
        ArrayList<Livro> livros = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            String sql = "SELECT l.*, a.nome_aut as nome_autor " +
                    "FROM livro l JOIN autor a ON l.id_autor_liv = a.id_aut";
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);

            while (rs.next()) {
                Livro l = new Livro();
                l.setId_liv(rs.getInt("id_liv"));
                l.setTitulo_liv(rs.getString("titulo_liv"));
                l.setIsbn_liv(rs.getString("isbn_liv"));
                l.setAno_publicacao_liv(rs.getInt("ano_publicacao_liv"));
                l.setId_autor_liv(rs.getInt("id_autor_liv"));
                l.setDisponivel_liv(rs.getBoolean("disponivel_liv"));

                // Adiciona o nome do autor
                l.setNome_autor(rs.getString("nome_autor"));
                livros.add(l);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return livros;
    }

    public ArrayList<Livro> getLivrosDisponiveis() {
        ArrayList<Livro> livros = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres();
             Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(
                     "SELECT l.*, a.nome_aut FROM livro l JOIN autor a ON l.id_autor_liv = a.id_aut WHERE l.disponivel_liv = true"
             )) {
            while (rs.next()) {
                Livro l = new Livro();
                l.setId_liv(rs.getInt("id_liv"));
                l.setTitulo_liv(rs.getString("titulo_liv"));
                l.setIsbn_liv(rs.getString("isbn_liv"));
                l.setAno_publicacao_liv(rs.getInt("ano_publicacao_liv"));
                l.setId_autor_liv(rs.getInt("id_autor_liv"));
                l.setDisponivel_liv(rs.getBoolean("disponivel_liv"));
                l.setNome_autor(rs.getString("nome_aut")); // Ensure author name is also set for available books
                livros.add(l);
            }
        } catch (SQLException | ClassNotFoundException ex) {
            ex.printStackTrace();
        }
        return livros;
    }

    public Livro getLivroById(int id) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "SELECT l.*, a.nome_aut FROM livro l JOIN autor a ON l.id_autor_liv = a.id_aut WHERE l.id_liv = ?"
            );
            stmt.setInt(1, id);
            ResultSet rs = stmt.executeQuery();
            if (rs.next()) {
                Livro l = new Livro();
                l.setId_liv(rs.getInt("id_liv"));
                l.setTitulo_liv(rs.getString("titulo_liv"));
                l.setIsbn_liv(rs.getString("isbn_liv"));
                l.setAno_publicacao_liv(rs.getInt("ano_publicacao_liv"));
                l.setId_autor_liv(rs.getInt("id_autor_liv"));
                l.setDisponivel_liv(rs.getBoolean("disponivel_liv"));
                l.setNome_autor(rs.getString("nome_aut")); // Ensure author name is also set
                return l;
            }
        } catch (SQLException | ClassNotFoundException ex) {
            ex.printStackTrace();
        }
        return null;
    }

    public String alterar(Livro livro) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "UPDATE livro SET titulo_liv = ?, isbn_liv = ?, ano_publicacao_liv = ?, id_autor_liv = ?, disponivel_liv = ? WHERE id_liv = ?"
            );
            stmt.setString(1, livro.getTitulo_liv());
            stmt.setString(2, livro.getIsbn_liv());
            stmt.setInt(3, livro.getAno_publicacao_liv());
            stmt.setInt(4, livro.getId_autor_liv());
            stmt.setBoolean(5, livro.isDisponivel_liv());
            stmt.setInt(6, livro.getId_liv());
            int updateCount = stmt.executeUpdate();
            if (updateCount <= 0) {
                return "Nenhum livro atualizado";
            }
            return "Livro atualizado com sucesso";
        } catch (SQLException | ClassNotFoundException ex) {
            ex.printStackTrace();
            return "Erro ao atualizar livro";
        }
    }

    public String excluir(int id) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement("DELETE FROM livro WHERE id_liv = ?");
            stmt.setInt(1, id);
            int updateCount = stmt.executeUpdate();
            if (updateCount <= 0) {
                return "Nenhum livro excluído";
            }
            return "Livro excluído com sucesso";
        } catch (SQLException | ClassNotFoundException ex) {
            ex.printStackTrace();
            return "Erro ao excluir livro";
        }
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\dao\UsuarioDAO.java:
package br.csi.dao;
import br.csi.model.Usuario;
import java.sql.*;
import java.util.ArrayList;

public class UsuarioDAO {
    public Usuario autenticar(String email, String senha) {
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres()) {
            PreparedStatement stmt = conn.prepareStatement(
                    "SELECT * FROM usuario WHERE email_us = ? AND senha_us = ? AND ativo_us = true"
            );
            stmt.setString(1, email);
            stmt.setString(2, senha);
            ResultSet rs = stmt.executeQuery();
            if (rs.next()) {
                Usuario u = new Usuario();
                u.setId_us(rs.getInt("id_us"));
                u.setEmail_us(rs.getString("email_us"));
                u.setSenha_us(rs.getString("senha_us"));
                u.setNome_us(rs.getString("nome_us"));
                u.setTipo_us(rs.getString("tipo_us"));
                return u;
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return null;
    }

    public ArrayList<Usuario> getUsuariosAtivos() {
        ArrayList<Usuario> usuarios = new ArrayList<>();
        try (Connection conn = ConectarBancoDados.conectarBancoPostgres();
             Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(
                     "SELECT * FROM usuario WHERE ativo_us = true AND tipo_us = 'USUARIO'"
             )) {
            while (rs.next()) {
                Usuario u = new Usuario();
                u.setId_us(rs.getInt("id_us"));
                u.setEmail_us(rs.getString("email_us"));
                u.setNome_us(rs.getString("nome_us"));
                usuarios.add(u);
            }
        } catch (SQLException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        return usuarios;
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\model\Autor.java:
package br.csi.model;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;

public class Autor {
    private int id_aut;
    private String nome_aut;
    private String nacionalidade_aut;
    private String data_nascimento_aut;

    // Getters e Setters
    public int getId_aut() { return id_aut; }
    public void setId_aut(int id_aut) { this.id_aut = id_aut; }

    public String getNome_aut() { return nome_aut; }
    public void setNome_aut(String nome_aut) {
        if (nome_aut == null || nome_aut.trim().isEmpty()) {
            throw new IllegalArgumentException("Nome do autor é obrigatório");
        }
        this.nome_aut = nome_aut;
    }

    public String getNacionalidade_aut() { return nacionalidade_aut; }
    public void setNacionalidade_aut(String nacionalidade_aut) {
        this.nacionalidade_aut = nacionalidade_aut;
    }

    public String getData_nascimento_aut() { return data_nascimento_aut; }
    public void setData_nascimento_aut(String data_nascimento_aut) {
        if (data_nascimento_aut == null || data_nascimento_aut.trim().isEmpty()) {
            throw new IllegalArgumentException("Data de nascimento é obrigatória");
        }

        // Converte para o formato AAAA-MM-dd para o input type="date"
        try {
            LocalDate date = LocalDate.parse(data_nascimento_aut);
            this.data_nascimento_aut = date.format(DateTimeFormatter.ISO_LOCAL_DATE);
        } catch (Exception e) {
            throw new IllegalArgumentException("Formato de data inválido. Use o formato AAAA-MM-DD");
        }
    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\model\Emprestimo.java:
package br.csi.model;
import java.sql.Date;
public class Emprestimo {
    private int id_emp;
    private int id_livro_emp;
    private int id_usuario_emp;
    private Date data_emprestimo_emp;
    private Date data_devolucao_prevista_emp;
    private Date data_devolucao_efetiva_emp;
    private String status_emp;
    //extras - para exibir
    private String titulo_livro;
    private String nome_usuario;

    // Getters e Setters
    public int getId_emp() { return id_emp; }
    public void setId_emp(int id_emp) { this.id_emp = id_emp; }
    public int getId_livro_emp() { return id_livro_emp; }
    public void setId_livro_emp(int id_livro_emp) { this.id_livro_emp = id_livro_emp; }
    public int getId_usuario_emp() { return id_usuario_emp; }
    public void setId_usuario_emp(int id_usuario_emp) { this.id_usuario_emp = id_usuario_emp; }
    public Date getData_emprestimo_emp() { return data_emprestimo_emp; }
    public void setData_emprestimo_emp(Date data_emprestimo_emp) { this.data_emprestimo_emp = data_emprestimo_emp; }
    public Date getData_devolucao_prevista_emp() { return data_devolucao_prevista_emp; }
    public void setData_devolucao_prevista_emp(Date data_devolucao_prevista_emp) { this.data_devolucao_prevista_emp = data_devolucao_prevista_emp; }
    public Date getData_devolucao_efetiva_emp() { return data_devolucao_efetiva_emp; }
    public void setData_devolucao_efetiva_emp(Date data_devolucao_efetiva_emp) { this.data_devolucao_efetiva_emp = data_devolucao_efetiva_emp; }
    public String getStatus_emp() { return status_emp; }
    public void setStatus_emp(String status_emp) { this.status_emp = status_emp; }

    public String getTitulo_livro() { return titulo_livro; }
    public void setTitulo_livro(String titulo_livro) { this.titulo_livro = titulo_livro; }

    public String getNome_usuario() { return nome_usuario; }
    public void setNome_usuario(String nome_usuario) { this.nome_usuario = nome_usuario; }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\model\Livro.java:
package br.csi.model;

public class Livro {
    private int id_liv;
    private String titulo_liv;
    private String isbn_liv;
    private int ano_publicacao_liv;
    private int id_autor_liv;
    private boolean disponivel_liv;
    //extras - para exibir
    private String nome_autor;
    // Getters e Setters
    public int getId_liv() { return id_liv; }
    public void setId_liv(int id_liv) { this.id_liv = id_liv; }
    public String getTitulo_liv() { return titulo_liv; }
    public void setTitulo_liv(String titulo_liv) { this.titulo_liv = titulo_liv; }
    public String getIsbn_liv() { return isbn_liv; }
    public void setIsbn_liv(String isbn_liv) { this.isbn_liv = isbn_liv; }
    public int getAno_publicacao_liv() { return ano_publicacao_liv; }
    public void setAno_publicacao_liv(int ano_publicacao_liv) { this.ano_publicacao_liv = ano_publicacao_liv; }
    public int getId_autor_liv() { return id_autor_liv; }
    public void setId_autor_liv(int id_autor_liv) { this.id_autor_liv = id_autor_liv; }
    public boolean isDisponivel_liv() { return disponivel_liv; }
    public void setDisponivel_liv(boolean disponivel_liv) { this.disponivel_liv = disponivel_liv; }

    public String getNome_autor() { return nome_autor; }
    public void setNome_autor(String nome_autor) { this.nome_autor = nome_autor; }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\model\Usuario.java:
package br.csi.model;

public class Usuario {
    private int id_us;
    private String email_us;
    private String senha_us;
    private String nome_us;
    private boolean ativo_us;
    private String tipo_us;
    // Getters e Setters
    public int getId_us() { return id_us; }
    public void setId_us(int id_us) { this.id_us = id_us; }
    public String getEmail_us() { return email_us; }
    public void setEmail_us(String email_us) { this.email_us = email_us; }
    public String getSenha_us() { return senha_us; }
    public void setSenha_us(String senha_us) { this.senha_us = senha_us; }
    public String getNome_us() { return nome_us; }
    public void setNome_us(String nome_us) { this.nome_us = nome_us; }
    public boolean isAtivo_us() { return ativo_us; }
    public void setAtivo_us(boolean ativo_us) { this.ativo_us = ativo_us; }
    public String getTipo_us() { return tipo_us; }
    public void setTipo_us(String tipo_us) { this.tipo_us = tipo_us; }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\java\br\csi\service\LoginService.java:
package br.csi.service;
import br.csi.dao.UsuarioDAO;
import br.csi.model.Usuario;

public class LoginService {

    private static UsuarioDAO usuarioDAO = new UsuarioDAO();

    public Usuario autenticar(String email, String senha) {

        Usuario usuario = usuarioDAO.autenticar(email, senha);
        if (usuario == null) {
            return null;
        } else {
            return usuario;
        }

    }
}echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\index.jsp:
<html>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<h2>Sistema de Gerenciamento</h2>
<ul>
    <c:if test="${sessionScope.usuarioLogado.tipo_us eq 'ADMIN'}">
        <li><a href="${pageContext.request.contextPath}/autores">Autores</a></li>
        <li><a href="${pageContext.request.contextPath}/livros">Livros</a></li>
        <li><a href="${pageContext.request.contextPath}/emprestimos">Emprestimos</a></li>
    </c:if>
    <li><a href="${pageContext.request.contextPath}/meus-emprestimos">Meus Empréstimos</a></li>
    <li><a href="${pageContext.request.contextPath}/logout">Sair</a></li>
</ul>

</body>
</html>

<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Login - Sistema Biblioteca</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .login-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 300px;
            text-align: center;
        }
        h2 {
            color: #333;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
        }
        input[type="email"],
        input[type="password"] {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button[type="submit"] {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        button[type="submit"]:hover {
            background-color: #0056b3;
        }
        .error {
            color: red;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
<div class="login-container">
    <h2>Login</h2>
    <c:if test="${not empty erro}">
        <p class="error">${erro}</p>
    </c:if>
    <form action="${pageContext.request.contextPath}/login" method="post">
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
            <label for="senha">Senha:</label>
            <input type="password" id="senha" name="senha" required>
        </div>
        <button type="submit">Entrar</button>
    </form>
</div>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\login.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Login - Sistema Biblioteca</title>
    <style>
        .login-container { width: 300px; margin: 100px auto; }
        .error { color: red; }
    </style>
</head>
<body>
<div class="login-container">
    <h2>Login</h2>
    <c:if test="${not empty erro}">
        <p class="error">${erro}</p>
    </c:if>
    <form action="${pageContext.request.contextPath}/login" method="post">
        <div>
            <label>Email:</label>
            <input type="email" name="email" required>
        </div>
        <div>
            <label>Senha:</label>
            <input type="password" name="senha" required>
        </div>
        <button type="submit">Entrar</button>
    </form>
</div>
</body>
</html>
echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\acessoNegado.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Acesso Negado</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            text-align: center;
            padding-top: 50px;
        }
        .container {
            background-color: #fff;
            margin: 0 auto;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 500px;
        }
        h1 {
            color: #dc3545; /* Bootstrap danger red */
        }
        p {
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Acesso Negado!</h1>
    <p>${mensagemAcessoNegado}</p>
    <p>Você não tem permissão para acessar esta página.</p>
    <p><a href="${pageContext.request.contextPath}/home">Voltar para Home</a></p>
</div>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\home.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Home - Sistema Biblioteca</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
        }
        p {
            margin-bottom: 20px;
        }
        nav ul {
            list-style-type: none;
            padding: 0;
        }
        nav li {
            margin-bottom: 10px;
        }
        nav a {
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
            padding: 8px 12px;
            border: 1px solid #007bff;
            border-radius: 5px;
            display: inline-block;
            transition: background-color 0.3s, color 0.3s;
        }
        nav a:hover {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<h1>Bem-vindo, ${usuarioLogado.nome_us}!</h1>
<p>Você está logado como: ${usuarioLogado.tipo_us}</p>

<nav>
    <ul>
        <c:if test="${usuarioLogado.tipo_us eq 'ADMIN'}">
            <li><a href="${pageContext.request.contextPath}/autores">Gerenciar Autores</a></li>
            <li><a href="${pageContext.request.contextPath}/livros">Gerenciar Livros</a></li>
            <li><a href="${pageContext.request.contextPath}/emprestimos">Gerenciar Empréstimos</a></li>
        </c:if>
        <c:if test="${usuarioLogado.tipo_us eq 'USUARIO'}">
        <li><a href="${pageContext.request.contextPath}/meus-emprestimos">Meus Empréstimos</a></li>
        </c:if>
        <li><a href="${pageContext.request.contextPath}/logout">Sair</a></li>
    </ul>
</nav>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\web.xml:
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
         version="5.0">
  <display-name>biblioteca</display-name>
  <welcome-file-list>
    <welcome-file>login.jsp</welcome-file>
  </welcome-file-list>

  <session-config>
    <session-timeout>1</session-timeout> <!-- Sessão expira em 1 minuto -->
  </session-config>

  <jsp-config>
    <jsp-property-group>
      <url-pattern>*.jsp</url-pattern>
      <el-ignored>false</el-ignored>
    </jsp-property-group>
  </jsp-config>
</web-app>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\autor\editar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>

<html>
<head>
    <title>${empty autorEdicao ? 'Novo Autor' : 'Editar Autor'}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 500px;
            margin-top: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 150px;
            font-weight: bold;
            vertical-align: middle;
        }
        input[type="text"],
        input[type="date"] {
            width: calc(100% - 160px);
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            vertical-align: middle;
        }
        button[type="submit"] {
            background-color: #28a745; /* Green for Save */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button[type="submit"]:hover {
            background-color: #218838;
        }
        a {
            text-decoration: none;
            color: #dc3545; /* Red for Cancel */
            padding: 10px 15px;
            border: 1px solid #dc3545;
            border-radius: 4px;
            font-size: 16px;
        }
        a:hover {
            background-color: #dc3545;
            color: white;
        }
        p[style="color: red;"] {
            background-color: #ffe0e0;
            border: 1px solid #ffb3b3;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
<h1>${empty autorEdicao ? 'Novo Autor' : 'Editar Autor'}</h1>

<c:if test="${not empty mensagem}">
    <p style="color: red;">${mensagem}</p>
</c:if>

<form action="${pageContext.request.contextPath}/autores" method="post">
    <c:if test="${not empty autorEdicao}">
        <input type="hidden" name="id" value="${autorEdicao.id_aut}">
    </c:if>

    <div class="form-group">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" value="${autorEdicao.nome_aut}" required>
    </div>

    <div class="form-group">
        <label for="nacionalidade">Nacionalidade:</label>
        <input type="text" id="nacionalidade" name="nacionalidade" value="${autorEdicao.nacionalidade_aut}">
    </div>

    <div class="form-group">
        <label for="data_nascimento">Data Nascimento:</label>
        <input type="date" id="data_nascimento" name="data_nascimento"
               value="${autorEdicao.data_nascimento_aut}" required>
    </div>

    <div class="form-group">
        <button type="submit">Salvar</button>
        <a href="${pageContext.request.contextPath}/autores">Cancelar</a>
    </div>
</form>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\autor\listar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Autores</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #e9ecef;
            color: #555;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e2e6ea;
        }
        .actions {
            white-space: nowrap;
            width: 150px; /* Adjust as needed */
        }
        .actions a {
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            margin-right: 5px;
        }
        .actions a:hover {
            opacity: 0.8;
        }
        .actions a:first-child { /* Editar */
            background-color: #ffc107; /* Yellow */
            color: #333;
        }
        .actions a:last-child { /* Excluir */
            background-color: #dc3545; /* Red */
            color: white;
        }
        .btn-novo {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 20px;
            display: inline-block;
            transition: background-color 0.3s;
        }
        .btn-novo:hover {
            background-color: #0056b3;
        }
        p[style="color: green;"] {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        div[style="margin-top: 20px;"] a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 12px;
            border: 1px solid #007bff;
            border-radius: 5px;
            display: inline-block;
            transition: background-color 0.3s, color 0.3s;
        }
        div[style="margin-top: 20px;"] a:hover {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>
<h1>Autores</h1>

<c:if test="${not empty mensagem}">
    <p style="color: green;">${mensagem}</p>
    <c:remove var="mensagem" scope="session"/>
</c:if>

<a href="${pageContext.request.contextPath}/autores?acao=novo" class="btn-novo">Novo Autor</a>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Nome</th>
        <th>Nacionalidade</th>
        <th>Ano de Nascimento</th>
        <th class="actions">Ações</th>
    </tr>
    </thead>
    <tbody>
    <c:forEach items="${autores}" var="autor">
        <tr>
            <td>${autor.id_aut}</td>
            <td>${autor.nome_aut}</td>
            <td>${autor.nacionalidade_aut}</td>
            <td>${autor.data_nascimento_aut}</td>
            <td class="actions">
                <a href="${pageContext.request.contextPath}/autores?acao=editar&id=${autor.id_aut}">Editar</a>
                <a href="${pageContext.request.contextPath}/autores?acao=excluir&id=${autor.id_aut}"
                   onclick="return confirm('Tem certeza que deseja excluir este autor?')">Excluir</a>
            </td>
        </tr>
    </c:forEach>
    </tbody>
</table>

<div style="margin-top: 20px;">
    <a href="${pageContext.request.contextPath}/home">Voltar para Home</a>
</div>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\emprestimo\editar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Novo Empréstimo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 500px;
            margin-top: 20px;
        }
        div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button[type="submit"] {
            background-color: #28a745; /* Green for Register */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button[type="submit"]:hover {
            background-color: #218838;
        }
        a {
            text-decoration: none;
            color: #dc3545; /* Red for Cancel */
            padding: 10px 15px;
            border: 1px solid #dc3545;
            border-radius: 4px;
            font-size: 16px;
        }
        a:hover {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<h1>Novo Empréstimo</h1>

<form action="${pageContext.request.contextPath}/emprestimos" method="post">
    <div>
        <label>Livro:</label>
        <select name="livro" required>
            <option value="">Selecione um livro</option>
            <c:forEach items="${livros}" var="livro">
                <c:if test="${livro.disponivel_liv}">
                    <option value="${livro.id_liv}">${livro.titulo_liv} (${livro.isbn_liv})</option>
                </c:if>
            </c:forEach>
        </select>
    </div>

    <div>
        <label>Usuário:</label>
        <select name="usuario" required>
            <option value="">Selecione um usuário</option>
            <c:forEach items="${usuarios}" var="usuario">
                <option value="${usuario.id_us}">${usuario.nome_us} (${usuario.email_us})</option>
            </c:forEach>
        </select>
    </div>

    <button type="submit">Registrar Empréstimo</button>
    <a href="${pageContext.request.contextPath}/emprestimos">Cancelar</a>
</form>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\emprestimo\listar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Empréstimos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #e9ecef;
            color: #555;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e2e6ea;
        }
        .atrasado {
            color: red;
            font-weight: bold;
        }
        a {
            text-decoration: none;
            background-color: #007bff;
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            display: inline-block;
            margin-bottom: 20px;
            transition: background-color 0.3s;
        }
        a:hover {
            background-color: #0056b3;
        }
        .devolver-btn {
            background-color: #28a745; /* Green for Devolver */
        }
        .devolver-btn:hover {
            background-color: #218838;
        }
        p[style="color: green;"] {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .back-link {
            margin-top: 20px;
            display: inline-block;
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 12px;
            border: 1px solid #007bff;
            border-radius: 5px;
            transition: background-color 0.3s, color 0.3s;
        }
        .back-link:hover {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<h1>Empréstimos</h1>

<c:if test="${not empty mensagem}">
    <p style="color: green;">${mensagem}</p>
    <c:remove var="mensagem" scope="session"/>
</c:if>

<a href="${pageContext.request.contextPath}/emprestimos?acao=novo">Novo Empréstimo</a>

<table>
    <tr>
        <th>ID</th>
        <th>Livro</th>
        <th>Usuário</th>
        <th>Data Empréstimo</th>
        <th>Data Devolução Prevista</th>
        <th>Status</th>
        <th>Ações</th>
    </tr>
    <c:forEach items="${emprestimos}" var="emp">
        <tr class="${emp.status_emp eq 'ATRASADO' ? 'atrasado' : ''}">
            <td>${emp.id_emp}</td>
            <td>${emp.titulo_livro}</td>
            <td>${emp.nome_usuario}</td>
            <td>${emp.data_emprestimo_emp}</td>
            <td>${emp.data_devolucao_prevista_emp}</td>
            <td>${emp.status_emp}</td>
            <td>
                <c:if test="${emp.status_emp eq 'ATIVO'}">
                    <a href="${pageContext.request.contextPath}/emprestimos?acao=devolver&id=${emp.id_emp}" class="devolver-btn">Devolver</a>
                </c:if>
            </td>
        </tr>
    </c:forEach>
</table>

<a href="${pageContext.request.contextPath}/home" class="back-link">Voltar</a>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\emprestimo\meus-emprestimos.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
  <title>Meus Empréstimos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
      color: #333;
    }
    h1 {
      color: #007bff;
      margin-bottom: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      background-color: #fff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #e9ecef;
      color: #555;
      font-weight: bold;
    }
    tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    tr:hover {
      background-color: #e2e6ea;
    }
    .atrasado {
      color: red;
      font-weight: bold;
    }
    .action-links a {
      text-decoration: none;
      padding: 5px 10px;
      border-radius: 4px;
      margin-right: 5px;
      display: inline-block;
    }
    .action-links a:hover {
      opacity: 0.8;
    }
    .devolver-btn {
      background-color: #28a745; /* Green */
      color: white;
    }
    .devolver-btn:hover {
      background-color: #218838;
    }
    .new-loan-btn {
      background-color: #007bff;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
      margin-bottom: 20px;
      display: inline-block;
      transition: background-color 0.3s;
    }
    .new-loan-btn:hover {
      background-color: #0056b3;
    }
    .logout-link {
      margin-top: 20px;
      display: inline-block;
      color: #dc3545;
      text-decoration: none;
      font-weight: bold;
      padding: 8px 12px;
      border: 1px solid #dc3545;
      border-radius: 5px;
      transition: background-color 0.3s, color 0.3s;
    }
    .logout-link:hover {
      background-color: #dc3545;
      color: white;
    }
  </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
  <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<h1>Meus Empréstimos</h1>

<c:if test="${not empty mensagem}">
  <p style="color: green;">${mensagem}</p>
  <c:remove var="mensagem" scope="session"/>
</c:if>

<%-- Add New Loan button for users --%>
<a href="${pageContext.request.contextPath}/emprestimos?acao=novo" class="new-loan-btn">Novo Empréstimo</a>

<table>
  <tr>
    <th>ID</th>
    <th>Livro</th>
    <th>Data Empréstimo</th>
    <th>Data Devolução Prevista</th>
    <th>Status</th>
    <th>Ações</th>
  </tr>
  <c:forEach items="${emprestimos}" var="emp">
    <tr class="${emp.status_emp eq 'ATRASADO' ? 'atrasado' : ''}">
      <td>${emp.id_emp}</td>
      <td>${emp.titulo_livro}</td> <%-- Corrected to use titulo_livro from Emprestimo model --%>
      <td>${emp.data_emprestimo_emp}</td>
      <td>${emp.data_devolucao_prevista_emp}</td>
      <td>${emp.status_emp}</td>
      <td class="action-links">
        <c:if test="${emp.status_emp eq 'ATIVO'}">
          <a href="${pageContext.request.contextPath}/meus-emprestimos?acao=devolver&id=${emp.id_emp}" class="devolver-btn">Devolver</a>
        </c:if>
      </td>
    </tr>
  </c:forEach>
</table>

<a href="${pageContext.request.contextPath}/logout" class="logout-link">Sair</a>
</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\livro\editar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>${empty livro ? 'Novo Livro' : 'Editar Livro'}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        h3 {
            color: #dc3545; /* Red for access denied */
            margin-bottom: 20px;
        }
        form {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 500px;
            margin-top: 20px;
        }
        div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"],
        input[type="number"],
        select {
            width: calc(100% - 20px);
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button[type="submit"] {
            background-color: #28a745; /* Green for Save */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button[type="submit"]:hover {
            background-color: #218838;
        }
        a {
            text-decoration: none;
            color: #dc3545; /* Red for Cancel */
            padding: 10px 15px;
            border: 1px solid #dc3545;
            border-radius: 4px;
            font-size: 16px;
        }
        a:hover {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<c:choose>
    <c:when test="${usuarioLogado.tipo_us eq 'USUARIO'}">
        <h3>Você não tem acesso a essa página.</h3>
    </c:when>
    <c:otherwise>
        <h1>${empty livro ? 'Novo Livro' : 'Editar Livro'}</h1>

        <form action="${pageContext.request.contextPath}/livros" method="post">
            <c:if test="${not empty livro}">
                <input type="hidden" name="id" value="${livro.id_liv}">
            </c:if>

            <div>
                <label>Título:</label>
                <input type="text" name="titulo" value="${livro.titulo_liv}" required>
            </div>

            <div>
                <label>ISBN:</label>
                <input type="text" name="isbn" value="${livro.isbn_liv}" required>
            </div>

            <div>
                <label>Ano Publicação:</label>
                <input type="number" name="ano" value="${livro.ano_publicacao_liv}" required>
            </div>

            <div>
                <label>Autor:</label>
                <select name="autor" required>
                    <option value="">Selecione um autor</option>
                    <c:forEach items="${autores}" var="autor">
                        <option value="${autor.id_aut}"
                            ${livro.id_autor_liv eq autor.id_aut ? 'selected' : ''}>
                                ${autor.nome_aut}
                        </option>
                    </c:forEach>
                </select>
            </div>

            <button type="submit">Salvar</button>
            <a href="${pageContext.request.contextPath}/livros">Cancelar</a>
        </form>
    </c:otherwise>
</c:choose>

</body>
</html>echo ..
..
- Endereço: C:\Users\Cliente\nicolegg13\copia-poo-biblio\src\main\webapp\WEB-INF\livro\listar.jsp:
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<html>
<head>
    <title>Livros</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1 {
            color: #007bff;
            margin-bottom: 20px;
        }
        h3 {
            color: #dc3545; /* Red for access denied */
            margin-bottom: 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #e9ecef;
            color: #555;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background-color: #e2e6ea;
        }
        .action-links {
            white-space: nowrap;
            width: 150px; /* Adjust as needed */
        }
        .action-links a {
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            margin-right: 5px;
        }
        .action-links a:hover {
            opacity: 0.8;
        }
        .action-links a:first-child { /* Editar */
            background-color: #ffc107; /* Yellow */
            color: #333;
        }
        .action-links a:last-child { /* Excluir */
            background-color: #dc3545; /* Red */
            color: white;
        }
        .new-livro-btn {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 20px;
            display: inline-block;
            transition: background-color 0.3s;
        }
        .new-livro-btn:hover {
            background-color: #0056b3;
        }
        .back-link {
            margin-top: 20px;
            display: inline-block;
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            padding: 8px 12px;
            border: 1px solid #007bff;
            border-radius: 5px;
            transition: background-color 0.3s, color 0.3s;
        }
        .back-link:hover {
            background-color: #007bff;
            color: white;
        }
    </style>
</head>
<body>

<c:if test="${empty sessionScope.usuarioLogado}">
    <script>window.location='${pageContext.request.contextPath}/login';</script>
</c:if>

<c:choose>
    <c:when test="${usuarioLogado.tipo_us eq 'USUARIO'}">
        <h3>Você não tem acesso a essa página.</h3>
        <p><a href="${pageContext.request.contextPath}/home" class="back-link">Voltar para Home</a></p>
    </c:when>
    <c:otherwise>
        <h1>Livros</h1>

        <a href="${pageContext.request.contextPath}/livros?acao=novo" class="new-livro-btn">Novo Livro</a>

        <table>
            <tr>
                <th>ID</th>
                <th>Título</th>
                <th>ISBN</th>
                <th>Ano Publicação</th>
                <th>Autor</th>
                <th>Disponível</th>
                <th>Ações</th>
            </tr>
            <c:forEach items="${livros}" var="livro">
                <tr>
                    <td>${livro.id_liv}</td>
                    <td>${livro.titulo_liv}</td>
                    <td>${livro.isbn_liv}</td>
                    <td>${livro.ano_publicacao_liv}</td>
                    <td>${livro.nome_autor}</td>
                    <td>${livro.disponivel_liv ? "Sim" : "Não"}</td>
                    <td class="action-links">
                        <a href="${pageContext.request.contextPath}/livros?acao=editar&id=${livro.id_liv}">Editar</a>
                        <a href="${pageContext.request.contextPath}/livros?acao=excluir&id=${livro.id_liv}"
                           onclick="return confirm('Tem certeza que deseja excluir?')">Excluir</a>
                    </td>
                </tr>
            </c:forEach>
        </table>
        <a href="${pageContext.request.contextPath}/home" class="back-link">Voltar</a>
    </c:otherwise>
</c:choose>

</body>
</html> 
